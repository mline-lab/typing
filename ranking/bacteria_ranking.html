<!DOCTYPE html>
<html>
<head>
<title>LostColor-トータルランキング-</title>
<meta charset="utf-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<link rel="stylesheet" href="../css/ranking.css" type="text/css">
<script src="js/jquery.pagination.js"></script>
<script>

$(function(){
  $('tr#list').pagination({
      pager        : $('.pager'),
      prevText     : '＜',
      nextText     : '＞',
      firstText    : '≪',
      lastText     : '≫',
      viewNum      : 30,
      pagerNum     : 10,
      ellipsis     : true,
      linkInvalid  : true,
      goTop        : true,
      firstLastNav : true,
      prevNextNav  : false
  });
});

</script>
</head>
<body>
  <div class="head_menu">
          <ul id="menu">
              <a href="./"><li>HOME</li></a>
              <a href="../mode1/ranking_view.html"><li>ノーマル</li></a>
              <a href="../mode2/ranking_view.html"><li>正確重視</li></a>
              <a href="../mode3/ranking_view.html"><li>速度重視</li></a>
              <a href="../mode4/ranking_view.html"><li>ノーミス</li></a>
          </ul>
  </div>
  <div class="main">
    <div>

      <div class="content">
        <table border="1" cellspacing="0" cellpadding="5" bordercolor="#333333">
          <tr>
            <th bgcolor="#81fcf1">順位</th>
            <th bgcolor="#81fcf1">名前</th>
            <th bgcolor="#81fcf1">スコア</th>
            <th bgcolor="#81fcf1">討伐数</th>
            <th bgcolor="#81fcf1">ミス数</th>
            <th bgcolor="#81fcf1">モード</th>
          </tr>
  <?php

  $dsn = 'mysql:dbname=typing;host=localhost';
  $user = 'root';
  $password = 'manaki079';

  $rank = 0;

  $mode;

  try{
      $dbh = new PDO($dsn, $user, $password);

      if ($dbh == null){
          //接続失敗
      }else{
          //接続成功
      }

      $dbh->query('SET NAMES utf8');

      $sql = 'SELECT * FROM score ORDER BY score DESC';
      $stmt = $dbh->query($sql);

      while($result = $stmt->fetch(PDO::FETCH_ASSOC)){
        switch ($result['mode']) {
          case 1:
            $mode = "ノーマル";
            break;
          case 2:
            $mode = "正確重視";
            break;
          case 3:
            $mode = "速度重視";
            break;
          case 4:
            $mode = "ノーミス";
            break;
          default:
            # code...
            break;
        }
          $rank++;
          echo "<tr id=\"list\">";
          echo "<th>";
          echo ($rank);
          echo "<th class=\"name\">";
          echo($result['name']);
          echo "</th>";
          echo "<th>";
          echo($result['score']);
          echo "</th>";
          echo "<th>";
          echo($result['count']);
          echo "</th>";
          echo "<th>";
          echo($result['miss']);
          echo "</th>";
          echo "<th>";
          echo($mode);
          echo "</th>";
          echo "</tr>";
      }

      }catch (PDOException $e){
        print('Error:'.$e->getMessage());
        die();
      }

  $dbh = null;

   ?>
   </table>
   </div>

  <div class="pager"></div>
  <div class="pageNum">
    <span class="nownum"></span>/<span class="totalnum"></span>pages
  </div>

   </div>
  </div>
</body>
</html>
